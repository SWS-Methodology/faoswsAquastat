<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 The faoswsAquastatExternal module | AQUASTAT: Migration of the Statistical Processes into the SWS</title>
  <meta name="description" content="This online book describes the migration of the statistical processes associated with the AQUASTAT - FAO Global’s Water Information System into the Corporate Statistical Working System (SWS)" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 The faoswsAquastatExternal module | AQUASTAT: Migration of the Statistical Processes into the SWS" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover_book.png" />
  <meta property="og:description" content="This online book describes the migration of the statistical processes associated with the AQUASTAT - FAO Global’s Water Information System into the Corporate Statistical Working System (SWS)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 The faoswsAquastatExternal module | AQUASTAT: Migration of the Statistical Processes into the SWS" />
  
  <meta name="twitter:description" content="This online book describes the migration of the statistical processes associated with the AQUASTAT - FAO Global’s Water Information System into the Corporate Statistical Working System (SWS)" />
  <meta name="twitter:image" content="images/cover_book.png" />



<meta name="date" content="2020-04-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="AquastatQuestionnaire.html"/>
<link rel="next" href="faoswsAquastatUpdate.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>



<link rel="stylesheet" href="ess.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#welcome"><strong>Welcome</strong></a></li>
<li><a href="preface.html#preface"><strong>Preface</strong></a><ul>
<li><a href="preface.html#how-to-use-this-book"><strong>How to use this book</strong></a></li>
<li><a href="preface.html#why-to-use-the-sws"><strong>Why to use the SWS</strong></a></li>
<li><a href="preface.html#migration-team"><strong>Migration Team</strong></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="AquastatFramework.html"><a href="AquastatFramework.html"><i class="fa fa-check"></i><b>1</b> <strong>AQUASTAT Framework</strong></a><ul>
<li class="chapter" data-level="1.1" data-path="AquastatFramework.html"><a href="AquastatFramework.html#data-collection"><i class="fa fa-check"></i><b>1.1</b> <strong>Data Collection</strong></a></li>
<li class="chapter" data-level="1.2" data-path="AquastatFramework.html"><a href="AquastatFramework.html#questionnaire"><i class="fa fa-check"></i><b>1.2</b> <strong>Questionnaire</strong></a></li>
<li class="chapter" data-level="1.3" data-path="AquastatFramework.html"><a href="AquastatFramework.html#the-current-aquastat-information-management"><i class="fa fa-check"></i><b>1.3</b> <strong>The current AQUASTAT information management</strong></a></li>
<li class="chapter" data-level="1.4" data-path="AquastatFramework.html"><a href="AquastatFramework.html#aquastat-in-sws-proposed-dataflow"><i class="fa fa-check"></i><b>1.4</b> <strong>AQUASTAT in SWS: proposed dataflow</strong></a></li>
<li class="chapter" data-level="1.5" data-path="AquastatFramework.html"><a href="AquastatFramework.html#aquastat-elements"><i class="fa fa-check"></i><b>1.5</b> <strong>AQUASTAT Elements</strong></a><ul>
<li class="chapter" data-level="1.5.1" data-path="AquastatFramework.html"><a href="AquastatFramework.html#international-classification-systems"><i class="fa fa-check"></i><b>1.5.1</b> <strong>International Classification Systems</strong></a></li>
<li class="chapter" data-level="1.5.2" data-path="AquastatFramework.html"><a href="AquastatFramework.html#current-aquastat-variables"><i class="fa fa-check"></i><b>1.5.2</b> <strong>Current AQUASTAT Variables</strong></a></li>
<li class="chapter" data-level="1.5.3" data-path="AquastatFramework.html"><a href="AquastatFramework.html#current-aquastat-indicators"><i class="fa fa-check"></i><b>1.5.3</b> <strong>Current AQUASTAT indicators</strong></a></li>
<li class="chapter" data-level="1.5.4" data-path="AquastatFramework.html"><a href="AquastatFramework.html#current-external-data"><i class="fa fa-check"></i><b>1.5.4</b> <strong>Current External data</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="AquastatQuestionnaire.html"><a href="AquastatQuestionnaire.html"><i class="fa fa-check"></i><b>2</b> <strong>The faoswsAquastatQuestionnaire module</strong></a><ul>
<li class="chapter" data-level="2.1" data-path="AquastatQuestionnaire.html"><a href="AquastatQuestionnaire.html#steps"><i class="fa fa-check"></i><b>2.1</b> <strong>Steps</strong></a></li>
<li class="chapter" data-level="2.2" data-path="AquastatQuestionnaire.html"><a href="AquastatQuestionnaire.html#running-the-module"><i class="fa fa-check"></i><b>2.2</b> <strong>Running the module</strong></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="AquastatExternal.html"><a href="AquastatExternal.html"><i class="fa fa-check"></i><b>3</b> <strong>The faoswsAquastatExternal module</strong></a><ul>
<li class="chapter" data-level="3.1" data-path="AquastatExternal.html"><a href="AquastatExternal.html#steps-1"><i class="fa fa-check"></i><b>3.1</b> <strong>Steps</strong></a><ul>
<li class="chapter" data-level="3.1.1" data-path="AquastatExternal.html"><a href="AquastatExternal.html#identifies-aquastat-external-data-sources"><i class="fa fa-check"></i><b>3.1.1</b> <strong>Identifies AQUASTAT external data sources</strong></a></li>
<li class="chapter" data-level="3.1.2" data-path="AquastatExternal.html"><a href="AquastatExternal.html#reshapes-the-data-sources"><i class="fa fa-check"></i><b>3.1.2</b> <strong>Reshapes the data sources</strong></a></li>
<li class="chapter" data-level="3.1.3" data-path="AquastatExternal.html"><a href="AquastatExternal.html#maps-out-aquastat-to-external-sources"><i class="fa fa-check"></i><b>3.1.3</b> <strong>Maps out AQUASTAT to external sources</strong></a></li>
<li class="chapter" data-level="3.1.4" data-path="AquastatExternal.html"><a href="AquastatExternal.html#maps-out-faostat-areas-to-unsdm49"><i class="fa fa-check"></i><b>3.1.4</b> <strong>Maps out FAOSTAT areas to UNSDM49</strong></a></li>
<li class="chapter" data-level="3.1.5" data-path="AquastatExternal.html"><a href="AquastatExternal.html#saves-the-output-back-into-sws"><i class="fa fa-check"></i><b>3.1.5</b> <strong>Saves the output back into SWS</strong></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="AquastatExternal.html"><a href="AquastatExternal.html#running-the-module-1"><i class="fa fa-check"></i><b>3.2</b> <strong>Running the module</strong></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html"><i class="fa fa-check"></i><b>4</b> <strong>The faoswsAquastaUpdate module</strong></a><ul>
<li class="chapter" data-level="4.1" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html#methods"><i class="fa fa-check"></i><b>4.1</b> <strong>Methods</strong></a><ul>
<li class="chapter" data-level="4.1.1" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html#calculate-indicators-first-calculation"><i class="fa fa-check"></i><b>4.1.1</b> <strong>Calculate indicators (<em>First Calculation</em>)</strong></a></li>
<li class="chapter" data-level="4.1.2" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html#vertical-imputation-components"><i class="fa fa-check"></i><b>4.1.2</b> <strong>Vertical Imputation (components)</strong></a></li>
<li class="chapter" data-level="4.1.3" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html#linear-interpolation-and-carry-forward"><i class="fa fa-check"></i><b>4.1.3</b> <strong>Linear Interpolation and Carry-Forward</strong></a></li>
<li class="chapter" data-level="4.1.4" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html#recalculate-indicators-second-calculation"><i class="fa fa-check"></i><b>4.1.4</b> <strong>Recalculate indicators (<em>Second calculation</em>)</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html#running-the-module-2"><i class="fa fa-check"></i><b>4.2</b> <strong>Running the module</strong></a></li>
<li class="chapter" data-level="4.3" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html#flag-assignment"><i class="fa fa-check"></i><b>4.3</b> <strong>Flag Assignment</strong></a></li>
<li class="chapter" data-level="4.4" data-path="faoswsAquastatUpdate.html"><a href="faoswsAquastatUpdate.html#aquastat-network"><i class="fa fa-check"></i><b>4.4</b> <strong>AQUASTAT Network</strong></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="AquastatValidation.html"><a href="AquastatValidation.html"><i class="fa fa-check"></i><b>5</b> <strong>The faoswsAquastatValidation module</strong></a><ul>
<li class="chapter" data-level="5.1" data-path="AquastatValidation.html"><a href="AquastatValidation.html#steps-2"><i class="fa fa-check"></i><b>5.1</b> <strong>Steps</strong></a><ul>
<li class="chapter" data-level="5.1.1" data-path="AquastatValidation.html"><a href="AquastatValidation.html#applies-validation-rules"><i class="fa fa-check"></i><b>5.1.1</b> <strong>Applies validation rules</strong></a></li>
<li class="chapter" data-level="5.1.2" data-path="AquastatValidation.html"><a href="AquastatValidation.html#focuses-on-high-priority-rules"><i class="fa fa-check"></i><b>5.1.2</b> <strong>Focuses on high priority rules</strong></a></li>
<li class="chapter" data-level="5.1.3" data-path="AquastatValidation.html"><a href="AquastatValidation.html#reshapes-and-adds-names-to-data"><i class="fa fa-check"></i><b>5.1.3</b> <strong>Reshapes and adds names to data</strong></a></li>
<li class="chapter" data-level="5.1.4" data-path="AquastatValidation.html"><a href="AquastatValidation.html#sends-the-output-to-the-user-email"><i class="fa fa-check"></i><b>5.1.4</b> <strong>Sends the output to the user email</strong></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="AquastatValidation.html"><a href="AquastatValidation.html#running-the-module-in-the-sws"><i class="fa fa-check"></i><b>5.2</b> <strong>Running the module in the SWS</strong></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Aggregation.html"><a href="Aggregation.html"><i class="fa fa-check"></i><b>6</b> <strong>The faoswsAquastatAggregation module</strong></a><ul>
<li class="chapter" data-level="6.1" data-path="Aggregation.html"><a href="Aggregation.html#steps-3"><i class="fa fa-check"></i><b>6.1</b> <strong>Steps</strong></a><ul>
<li class="chapter" data-level="6.1.1" data-path="Aggregation.html"><a href="Aggregation.html#calculate-region-specific-aggregations-for-sdg-6.4.2"><i class="fa fa-check"></i><b>6.1.1</b> <strong>Calculate region-specific aggregations for SDG 6.4.2</strong></a></li>
<li class="chapter" data-level="6.1.2" data-path="Aggregation.html"><a href="Aggregation.html#calculate-region-specific-aggregations-for-sdg-6.4.1"><i class="fa fa-check"></i><b>6.1.2</b> <strong>Calculate region-specific aggregations for SDG 6.4.1</strong></a></li>
<li class="chapter" data-level="6.1.3" data-path="Aggregation.html"><a href="Aggregation.html#send-the-result-to-the-user-email"><i class="fa fa-check"></i><b>6.1.3</b> <strong>Send the result to the user email</strong></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Aggregation.html"><a href="Aggregation.html#running-the-module-3"><i class="fa fa-check"></i><b>6.2</b> <strong>Running the module</strong></a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="sws-resources.html"><a href="sws-resources.html"><i class="fa fa-check"></i><b>A</b> SWS resources</a><ul>
<li class="chapter" data-level="A.1" data-path="sws-resources.html"><a href="sws-resources.html#code-lists"><i class="fa fa-check"></i><b>A.1</b> Code lists</a></li>
<li class="chapter" data-level="A.2" data-path="sws-resources.html"><a href="sws-resources.html#datatables"><i class="fa fa-check"></i><b>A.2</b> Datatables</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#aquastat-reference"><i class="fa fa-check"></i>AQUASTAT Reference</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#aquastat-faostat-mapping"><i class="fa fa-check"></i>AQUASTAT FAOSTAT Mapping</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#aquastat-sources"><i class="fa fa-check"></i>AQUASTAT Sources</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#calculation-rule"><i class="fa fa-check"></i>Calculation Rule</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#global-dam-reservoir"><i class="fa fa-check"></i>Global Dam Reservoir</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#global-map-of-irrigated-area"><i class="fa fa-check"></i>Global Map of Irrigated Area</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#aquastat-sdg-aggregates"><i class="fa fa-check"></i>AQUASTAT SDG Aggregates</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#aquastat-external-sources"><i class="fa fa-check"></i>AQUASTAT External sources</a></li>
<li class="chapter" data-level="" data-path="sws-resources.html"><a href="sws-resources.html#m49-fs-iso-mapping"><i class="fa fa-check"></i>M49 FS ISO Mapping</a></li>
<li class="chapter" data-level="A.3" data-path="sws-resources.html"><a href="sws-resources.html#datasets"><i class="fa fa-check"></i><b>A.3</b> Datasets</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">AQUASTAT: Migration of the Statistical Processes
into the SWS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="AquastatExternal" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> <strong>The faoswsAquastatExternal module</strong></h1>
<p>The <strong>faoswsAquastatExternal</strong> is essentially a data harvester that emerges as demand for making the AQUASTAT process of extracting and reshaping data from external sources (web databases) easier.</p>
<div class="figure" style="text-align: center"><span id="fig:figExternal"></span>
<img src="images/faoswsAquastatExetrnal.png" alt="Ideal Workflow of the faoswsAquastatExternal module" width="65%" />
<p class="caption">
Figure 3.1: Ideal Workflow of the faoswsAquastatExternal module
</p>
</div>
<p><em>Only Possible</em> <strong>Workflow</strong></p>
<br>
<div class="rmdnote">
<p>
<strong>FAOSTAT, the ONLY REACHABLE DATA SOURCE:</strong>
</p>
<p>
The harvest of all external data was proved to be not possible due to IT security reasons. During the development, it was noticed that SWS modules running in SWS could not access external downloadable links. The only exceptions are the data from FAOSTAT.
</p>
<p>
Therefore, while the module does not have the clearance to download external data, the <code>faoswsAquastatExternal</code> module will only harvest FAOSTAT data.
</p>
</div>
<p><br></p>
<div class="figure" style="text-align: center"><span id="fig:figExternalPossible"></span>
<img src="images/POSSIBLEfaoswsAquastatExetrnal.png" alt="Workflow of the faoswsAquastatExternal module harvesting FAOSTAT data only." width="65%" />
<p class="caption">
Figure 3.2: Workflow of the faoswsAquastatExternal module harvesting FAOSTAT data only.
</p>
</div>
<div id="steps-1" class="section level2">
<h2><span class="header-section-number">3.1</span> <strong>Steps</strong></h2>
<p>The module executes the following steps to harvester external (<code>FAOSTAT</code>) data.</p>
<div id="identifies-aquastat-external-data-sources" class="section level3">
<h3><span class="header-section-number">3.1.1</span> <strong>Identifies AQUASTAT external data sources</strong></h3>
<p>The module needs to identify the external data used by AQUASTAT. This identification is made with the help of the SWS datatable <strong>aqua_external_sources</strong> below:</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tab3">Table 3.1: </span>AQUASTAT external sources - First rows
</caption>
<thead>
<tr>
<th style="text-align:center;background-color: #b6c5d4 !important;position: sticky; top:0; background-color: #FFFFFF;">
element_code
</th>
<th style="text-align:center;background-color: #b6c5d4 !important;position: sticky; top:0; background-color: #FFFFFF;">
element_name
</th>
<th style="text-align:center;background-color: #b6c5d4 !important;position: sticky; top:0; background-color: #FFFFFF;">
source
</th>
<th style="text-align:center;background-color: #b6c5d4 !important;position: sticky; top:0; background-color: #FFFFFF;">
source_item_code
</th>
<th style="text-align:center;background-color: #b6c5d4 !important;position: sticky; top:0; background-color: #FFFFFF;">
source_element_code
</th>
<th style="text-align:center;background-color: #b6c5d4 !important;position: sticky; top:0; background-color: #FFFFFF;">
data_link
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
4100
</td>
<td style="text-align:center;">
Total area of the country (excl. coastal water)
</td>
<td style="text-align:center;">
FAOSTAT
</td>
<td style="text-align:center;">
6600
</td>
<td style="text-align:center;">
5110
</td>
<td style="text-align:center;">
<a href="http://fenixservices.fao.org/faostat/static/bulkdownloads/Inputs_LandUse_E_All_Data_(Normalized).zip" class="uri">http://fenixservices.fao.org/faostat/static/bulkdownloads/Inputs_LandUse_E_All_Data_(Normalized).zip</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
4101
</td>
<td style="text-align:center;">
Arable land area
</td>
<td style="text-align:center;">
FAOSTAT
</td>
<td style="text-align:center;">
6621
</td>
<td style="text-align:center;">
5110
</td>
<td style="text-align:center;">
<a href="http://fenixservices.fao.org/faostat/static/bulkdownloads/Inputs_LandUse_E_All_Data_(Normalized).zip" class="uri">http://fenixservices.fao.org/faostat/static/bulkdownloads/Inputs_LandUse_E_All_Data_(Normalized).zip</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
4102
</td>
<td style="text-align:center;">
Permanent crops area
</td>
<td style="text-align:center;">
FAOSTAT
</td>
<td style="text-align:center;">
6650
</td>
<td style="text-align:center;">
5110
</td>
<td style="text-align:center;">
<a href="http://fenixservices.fao.org/faostat/static/bulkdownloads/Inputs_LandUse_E_All_Data_(Normalized).zip" class="uri">http://fenixservices.fao.org/faostat/static/bulkdownloads/Inputs_LandUse_E_All_Data_(Normalized).zip</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
4103
</td>
<td style="text-align:center;">
Cultivated area (arable land + permanent crops)
</td>
<td style="text-align:center;">
FAOSTAT
</td>
<td style="text-align:center;">
6620
</td>
<td style="text-align:center;">
5110
</td>
<td style="text-align:center;">
<a href="http://fenixservices.fao.org/faostat/static/bulkdownloads/Inputs_LandUse_E_All_Data_(Normalized).zip" class="uri">http://fenixservices.fao.org/faostat/static/bulkdownloads/Inputs_LandUse_E_All_Data_(Normalized).zip</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
4104
</td>
<td style="text-align:center;">
Total population
</td>
<td style="text-align:center;">
FAOSTAT
</td>
<td style="text-align:center;">
3010
</td>
<td style="text-align:center;">
511
</td>
<td style="text-align:center;">
<a href="http://fenixservices.fao.org/faostat/static/bulkdownloads/Population_E_All_Data_(Normalized).zip" class="uri">http://fenixservices.fao.org/faostat/static/bulkdownloads/Population_E_All_Data_(Normalized).zip</a>
</td>
</tr>
<tr>
<td style="text-align:center;">
4105
</td>
<td style="text-align:center;">
Rural population
</td>
<td style="text-align:center;">
FAOSTAT
</td>
<td style="text-align:center;">
3010
</td>
<td style="text-align:center;">
551
</td>
<td style="text-align:center;">
<a href="http://fenixservices.fao.org/faostat/static/bulkdownloads/Population_E_All_Data_(Normalized).zip" class="uri">http://fenixservices.fao.org/faostat/static/bulkdownloads/Population_E_All_Data_(Normalized).zip</a>
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>After identification, the module downloads the data to temporary files and read it in to start the processing.</p>
</div>
<div id="reshapes-the-data-sources" class="section level3">
<h3><span class="header-section-number">3.1.2</span> <strong>Reshapes the data sources</strong></h3>
<p>Data from different sources are likely to occur in different formats. Therefore, after the download of the data, the module needs to apply a different reshaping strategy to each data source. Regardless the initial shape of the external AQUASTAT data sources, the module is going to convert <strong>each</strong> single source into an SWS long format dataset with <strong>geographicAreaM49</strong>, <strong>aquastatElement</strong>, <strong>timePointYears</strong>, <strong>flagOvservationStatus</strong> and <strong>flagMethod</strong>.</p>
<p>The <strong>flagOvservationStatus</strong> and <strong>flagMethod</strong> are <strong>“X”</strong> and <strong>“c”</strong> for all data extracted by the faoswsAquasatExternal module.</p>
</div>
<div id="maps-out-aquastat-to-external-sources" class="section level3">
<h3><span class="header-section-number">3.1.3</span> <strong>Maps out AQUASTAT to external sources</strong></h3>
<p>With the data already reshaped, it is effortless for the module to keep relevant AQUASTAT elements since the <strong>aqua_external_source</strong> data table provides the means for correctly mapping out the original external data code to AQUASTAT codes.</p>
</div>
<div id="maps-out-faostat-areas-to-unsdm49" class="section level3">
<h3><span class="header-section-number">3.1.4</span> <strong>Maps out FAOSTAT areas to UNSDM49</strong></h3>
<p>The SWS datatable <strong>m49_fs_iso_mapping</strong> has the correspondence among different international codes (FAOSTAT, UNSDM49, ISO2, ISO3) for geographic areas and is used to convert area codes in the external sources to UNSDM49 codes which is the standard in the SWS.</p>
</div>
<div id="saves-the-output-back-into-sws" class="section level3">
<h3><span class="header-section-number">3.1.5</span> <strong>Saves the output back into SWS</strong></h3>
<p>Finally, the module merges the sources into a single dataset. This output is an SWS-compliant long-format dataset name <strong>aquastat_external</strong> that is saved by the user in the SWS and will be ready to serve as an <strong>input</strong> of the <strong>faoswsAquastatUpdate</strong> module.</p>
<!--```{r fig1, echo=FALSE, fig.cap='Workflow of the faoswsAquastatExternal module.'}

library(DiagrammeR)
DiagrammeR::grViz("digraph {

graph [layout = dot, rankdir = LR]

# define the global styles of the nodes. We can override these in box if we wish
node [shape = rectangle, style = filled, fillcolor = Linen]

# Inputs
FAO [label = 'Dataset: \n FAO data', shape = folder, fillcolor = Beige]
ILO [label = 'Dataset: \n ILO data',  shape = folder, fillcolor = Beige]
UNDP [label = 'Dataset: \n ILO data',  shape = folder, fillcolor = Beige]
WB [label = 'Dataset: \n World Bank data',  shape = folder, fillcolor = Beige]
JMP [label = 'Dataset: \n JMP(WHO/UNICEF) data',  shape = folder, fillcolor = Beige]

# data tables
aquaexter [label = 'Data table: \n aqua_external_source data',  shape = folder, fillcolor = LightGrey]
m49iso [label = 'Data table: \n m49_fs_iso_mapping',  shape = folder, fillcolor = LightGrey]


# processing
externalmodule [label = ' Processing: \n faoswsAquastatExternal using:\n 1. Download and read in the data, \n 2. Reshape data \n to an long-format dataset, \n 3. Map out original codes to AQUASTAT codes, \n 4. Retain relevant elements', shape = rectangle, fillcolor = LightBlue]


# Output
Output [label = 'Dataset: \n aquastat_external \n External data in an SWS compliant dataset', shape = folder, fillcolor = Beige]

# Flow
# edge definitions with the node IDs
{FAO, ILO, UNDP, WB, JMP} -> externalmodule -> Output
{aquaexter, m49iso} -> externalmodule
}")

```-->
<!--```{r possiblewf, echo=FALSE, fig.cap='Workflow of the faoswsAquastatExternal module HARVESTING FAOSTAT data only.'}

library(DiagrammeR)
DiagrammeR::grViz("digraph {

graph [layout = dot, rankdir = LR]

# define the global styles of the nodes. We can override these in box if we wish
node [shape = rectangle, style = filled, fillcolor = Linen]

# Inputs
FAO [label = 'Dataset: \n FAO data', shape = folder, fillcolor = Beige]
ILO [label = 'Source: \n ILO data',  shape = folder, fillcolor = Red]
UNDP [label = 'Source: \n ILO data',  shape = folder, fillcolor = Red]
WB [label = 'Source: \n World Bank data',  shape = folder, fillcolor = Red]
JMP [label = 'Source: \n JMP(WHO/UNICEF) data',  shape = folder, fillcolor = Red]


blocked [label = 'Blocked: \n Data sources with access denied by SWS', fillcolor = Beige]

# data tables
aquaexter [label = 'Data table: \n aqua_external_sources',  shape = folder, fillcolor = LightGrey]
m49iso [label = 'Data table: \n m49_fs_iso_mapping',  shape = folder, fillcolor = LightGrey]


# processing
externalmodule [label = ' Processing: \n faoswsAquastatExternal using:\n 1. Download and read in the data, \n 2. Reshape data \n to an long-format dataset, \n 3. Map out original codes to AQUASTAT codes, \n 4. Retain relevant elements', shape = rectangle, fillcolor = LightBlue]


# Output
Output [label = 'Dataset: \n aquastat_external \n External data in an SWS compliant dataset', shape = folder, fillcolor = Beige]

# Flow
# edge definitions with the node IDs
{FAO} -> externalmodule -> Output
blocked -> {ILO, UNDP, WB, JMP}
{aquaexter,m49iso} -> externalmodule
}")

```-->
</div>
</div>
<div id="running-the-module-1" class="section level2">
<h2><span class="header-section-number">3.2</span> <strong>Running the module</strong></h2>
<ol style="list-style-type: decimal">
<li><p>Log in the SWS;</p></li>
<li><p>Click on <strong>New Query</strong>;</p></li>
<li><p>Select <strong>AQUASTAT domain</strong> and <strong>aquastat_external dataset</strong>;</p></li>
<li><p>Select whatever geographicM49Area, aquastatElement, and timePointYears;
<br></p>
<div class="figure"><span id="fig:extquery"></span>
<img src="images/aqua_external_query.png" alt="Steps 1 to 4" width="100%" />
<p class="caption">
Figure 3.3: Steps 1 to 4
</p>
</div>
<p><br>
<br></p>
<div class="rmdwarning">
<p>
The <strong>faoswsAquastatExternal</strong> searches and downloads data from external sources. Therefore, what the user is selecting in the query is irrelevant for the module’s output.
</p>
</div>
<p><br></p></li>
<li><p>Run the query and get an empty session;
<br></p>
<div class="figure"><span id="fig:extempty"></span>
<img src="images/aqua_external_empty.png" alt="Empty SWS session of the aquastat_external dataset" width="100%" />
<p class="caption">
Figure 3.4: Empty SWS session of the aquastat_external dataset
</p>
</div>
<p><br></p></li>
<li><p>Click on <strong>Run plugin</strong> on the top-right;</p></li>
<li><p>Select the <strong>faoswsAquastatExternal</strong> module and click on <strong>Run plugin</strong>;</p></li>
</ol>
<br>
<div class="figure"><span id="fig:extplugin"></span>
<img src="images/aqua_external_plugin.png" alt="Select the AquastatExternal plugin and run it" width="100%" />
<p class="caption">
Figure 3.5: Select the AquastatExternal plugin and run it
</p>
</div>
<p><br>
8. Wait for the results to appear in the session;</p>
<br>
<div class="figure"><span id="fig:extoutput"></span>
<img src="images/aqua_external_output.png" alt="Select the AquastatExternal plugin output in the session" width="100%" />
<p class="caption">
Figure 3.6: Select the AquastatExternal plugin output in the session
</p>
</div>
<p><br></p>
<ol start="9" style="list-style-type: decimal">
<li>Click on <strong>Save to dataset</strong>;</li>
</ol>
<div class="rmdtip">
<p>
The aquastat_external dataset has already been saved in the SWS database to prop up the <strong>faoswsAquastatUpdate</strong> module development. If the user knows that the External sources have not been updated, he/she does not neeed to save the dataset gain.
</p>
</div>
<p><br>
10. Email to the user.</p>
<br>
<div class="figure"><span id="fig:extemail"></span>
<img src="images/aqua_external_email.png" alt="The AquastatExternal output is emailed to the user." width="100%" />
<p class="caption">
Figure 3.7: The AquastatExternal output is emailed to the user.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="AquastatQuestionnaire.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="faoswsAquastatUpdate.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
